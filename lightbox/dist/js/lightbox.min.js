!function(a){var b=function(b){var c=this;this.settings={speed:500},a.extend(this.settings,b||{}),this.popupMask=a("<div id='G-lightbox-mask'></div>"),this.popupWin=a('<div id="G-lightbox-popup"></div>'),this.bodyNode=a(document.body),this.renderDom(),this.picViewArea=this.popupWin.find("div.lightbox-pic-view"),this.popupPic=this.popupWin.find("img.lightbox-image"),this.popCaptionArea=this.popupWin.find("div.light-pic-caption"),this.nextBtn=this.popupWin.find("span.lightbox-next-btn"),this.prevBtn=this.popupWin.find("span.lightbox-prev-btn"),this.captionText=this.popupWin.find("p.lightbox-pic-desc"),this.currentIndex=this.popupWin.find("span.lightbox-of-index"),this.closeBtn=this.popupWin.find("span.lightbox-close-btn"),this.groupName=null,this.groupData=[],this.bodyNode.delegate(".js-lightbox,*[data-role=lightbox]","click",function(b){b.stopPropagation();var d=a(this).attr("data-group");d!=c.groupName&&(c.groupName=d,c.getGroup()),c.initPopup(a(this))}),this.popupMask.click(function(){a(this).fadeOut(),c.popupWin.fadeOut(),c.clear=!1}),this.closeBtn.click(function(){c.popupMask.fadeOut(),c.popupWin.fadeOut(),c.clear=!1}),this.flag=!0,this.nextBtn.hover(function(){!a(this).hasClass("disabled")&&c.groupData.length>1&&a(this).addClass("lightbox-next-btn-show")},function(){!a(this).hasClass("disabled")&&c.groupData.length>1&&a(this).removeClass("lightbox-next-btn-show")}).click(function(b){b.stopPropagation(),!a(this).hasClass("disabled")&&c.flag&&(c.flag=!1,c["goto"]("next"))}),this.prevBtn.hover(function(){!a(this).hasClass("disabled")&&c.groupData.length>1&&a(this).addClass("lightbox-prev-btn-show")},function(){!a(this).hasClass("disabled")&&c.groupData.length>1&&a(this).removeClass("lightbox-prev-btn-show")}).click(function(b){b.stopPropagation(),!a(this).hasClass("disabled")&&c.flag&&(c.flag=!1,c["goto"]("prev"))});var d=null;c.clear=!1,a(window).resize(function(){c.clear&&(window.clearTimeout(d),d=window.setTimeout(function(){c.loadPicSize(c.groupData[c.index].src)},500))}).keyup(function(a){var b=a.which;38==b||37==b?c.prevBtn.click():(39==b||40==b)&&c.nextBtn.click()})};b.prototype={"goto":function(a){if("next"===a){this.index++,this.index>=this.groupData.length-1&&this.nextBtn.addClass("disabled").removeClass("lightbox-next-btn-show"),0!=this.index&&this.prevBtn.removeClass("disabled");var b=this.groupData[this.index].src;this.loadPicSize(b)}else if("prev"===a){this.index--,this.index<=0&&this.prevBtn.addClass("disabled").removeClass("lightbox-prev-btn-show"),this.index!=this.groupData.length-1&&this.nextBtn.removeClass("disabled");var b=this.groupData[this.index].src;this.loadPicSize(b)}},loadPicSize:function(a){var b=this;b.popupPic.css({width:"auto",height:"auto"}).hide(),b.popCaptionArea.hide(),this.preLoadImg(a,function(){b.popupPic.attr("src",a);var c=b.popupPic.width(),d=b.popupPic.height();b.changePic(c,d)})},changePic:function(b,c){var d=this,e=a(window).width(),f=a(window).height(),g=Math.min(e/(b+10),f/(c+10),1);b*=g,c*=g,this.picViewArea.animate({width:b-10,height:c-10},d.settings.speed),this.popupWin.animate({width:b,height:c,marginLeft:-(b/2),top:(f-c)/2},d.settings.speed,function(){d.popupPic.css({width:b-10,height:c-10}).fadeIn(),d.popCaptionArea.fadeIn(),d.flag=!0,d.clear=!0}),this.captionText.text(this.groupData[this.index].caption),this.currentIndex.text("当前索引:"+(this.index+1)+" of "+this.groupData.length)},preLoadImg:function(a,b){var c=new Image;window.ActiveXObject?c.onreadystatechange=function(){"complete"==this.readyState&&b()}:c.onload=function(){b()},c.src=a},showMaskAndPopup:function(b,c){var d=this;this.popupPic.hide(),this.popCaptionArea.hide(),this.popupMask.fadeIn();var e=a(window).width(),f=a(window).height();this.picViewArea.css({width:e/2,height:f/2}),this.popupWin.fadeIn();var g=f/2+10,h=e/2+10;this.popupWin.css({width:h,height:g,marginLeft:-h/2,top:-g}).animate({top:(f-g)/2},d.settings.speed,function(){d.loadPicSize(b)}),this.index=this.getIndexOf(c);var i=this.groupData.length;i>1&&(0===this.index?(this.prevBtn.addClass("disabled"),this.nextBtn.removeClass("disabled")):this.index===i-1?(this.nextBtn.addClass("disabled"),this.prevBtn.removeClass("disabled")):(this.prevBtn.removeClass("disabled"),this.nextBtn.removeClass("disabled")))},getIndexOf:function(b){var c=0;return a(this.groupData).each(function(a){return c=a,this.id===b?!1:void 0}),c},initPopup:function(a){var b=a.attr("data-source"),c=a.attr("data-id");this.showMaskAndPopup(b,c)},getGroup:function(){var b=this;b.groupData.length=0;var c=this.bodyNode.find("*[data-group="+this.groupName+"]");c.each(function(){b.groupData.push({src:a(this).attr("data-source"),id:a(this).attr("data-id"),caption:a(this).attr("data-caption")})})},renderDom:function(){var a='<div class="lightbox-pic-view"><span class="lightbox-btn lightbox-prev-btn"></span><img class="lightbox-image" alt=""><span class="lightbox-btn lightbox-next-btn"></span></div><div class="light-pic-caption"><div class="lightbox-caption-area"><p class="lightbox-pic-desc"></p><span class="lightbox-of-index">当前索引: 0 of 0</span></div><span class="lightbox-close-btn"></span></div>';this.popupWin.html(a),this.bodyNode.append(this.popupMask,this.popupWin)}},window.LightBox=b}(jQuery);
//# sourceMappingURL=lightbox.min.map